#!/bin/bash

# TODO
    # contain alpha-numeric characters plus '.', '-' and '_' characters.

if [ $# -eq 0 ]; then
    echo "usage: legit-add <filenames>";
    exit 1;
fi

if ! [ -d ".legit" ]; then
    echo "legit-add: error: no .legit directory containing legit repository exists";    # not $0
    exit 1;
fi

index='.legit/index';
for i in $@
do
    if echo "$i" | egrep -qv "^[a-zA-Z0-9.-_]"; then
        continue;
    fi

    if [ -f "$i" ]; then # [ -s "$i" ]
        # cat $i;
        # cpy into index
        cp "$i" "$index/$i"
    else
        echo "legit-add: error: can not open '$i'";
        exit 1;     # TODO: delete if fail autotest
    fi
done
